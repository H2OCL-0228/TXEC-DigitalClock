<!DOCTYPE html>
<html lang="zh-cn">
<!-- 腾云技协 Gitee 学生版: H2O_CL/TXEC-NightTimeClock_GS -->

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="塘厦二初腾云技协(TXECHYES@Github)">
  <meta name="description" content="数字时钟用于塘厦第二初级中学展示科目、起止时间、当前时间等信息。背景由二初图库提供，祝各位同学使用心情愉悦">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="./css/main.css">
  <link rel="stylesheet" href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css"
    media="none" onload="this.media='all'">
  <link rel="stylesheet" href="https://fonts.font.im/css?family=Ubuntu:400,700" media="none" onload="this.media='all'">
  <base target="_blank">
  <script type="text/javascript">
    (function (c, l, a, r, i, t, y) {
      c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
      t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
      y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
    })(window, document, "clarity", "script", "axvxzgha2e");
  </script>
  <title>初二数字时钟</title>
  <link rel="stylesheet" href="./css/snow.css">
</head>

<body>
  <div class="snow-container"></div>
  <div class="snow-toggle" title="切换下雪效果">
    <i class="fa-solid fa-snowflake"></i>
  </div>
  <link rel="stylesheet" href="./css/cover.css">
  <div id="coverLaunch">
    <p style="color: white; font-weight: bold;" >数字时钟用于塘厦第二初级中学展示科目、起止时间、当前时间等信息。背景由二初图库提供，祝各位同学使用心情愉悦</p>
  </div>

  <div id="cover">
    <div id="coverMask"></div>
    <div></div>
    <div class="coverMain">
      <div class="info">
        <div class="title skew">
          <div class="reskew">
            <p id="coverTitle">数字时钟</p>
            <p id="coverAuthor">腾云技协</p>
          </div>
          <div class="titleBadge">
            <div class="reskew">
              <p style="font-size:1.5em">7</p>
              <p style="font-size:.6em">EZ</p>
            </div>
          </div>
        </div>
        <div class="desc skew">
          <p class="reskew">
            <span class="dim">Chart</span><br>
            <span id="coverOrigin">塘厦第二初级中学</span>
          </p>
          <p class="reskew">
            <span class="dim">Illustration</span><br>
            <span id="bgHook">二初图库</span>
          </p>
        </div>
      </div>
      <div class="cover skew">
        <div class="reskew" id="coverImage"></div>
      </div>
    </div>
    <div class="dim space-between">
      <p>Tip: <span id="coverTips"></span></p>
      <p class="loadingBar">Loading~</p>
    </div>
  </div>

  <script src="./js/cover.js"></script>

  <div id="main" style="opacity:1;font-size:1em;">
    <div class="notify" style="position:sticky;top:0;z-index:100;">
      <div id="verify">
        <i class="fa-solid fa-shield"></i>
        <span id="verifycontent">安全提示内容</span>
      </div>
      <div id="msg">
        <p>
          <i class="fa-solid fa-circle-info"></i>
          <span id="msgcontent">消息内容</span>
        </p>
        <a class="fa-solid fa-xmark"></a>
      </div>
    </div>

    <div>  <!-- 移除min-height:100vh -->
      <nav class="space-between" style="position:sticky;top:60px;z-index:99;">
        <h2 id="mainslogan">数字时钟</h2>

        <div class="sub space-between space">
          <div class="dropdown" style="min-width:5.5em;">
            <a class="btn">
              <div class="space-between">
                <span id="type">选择类型</span>
                <i class="fa-solid fa-caret-down"></i>
              </div>
            </a>
            <div id="typelist" style="width:180px;">
              <a onclick="subject.switch(24)">周一晚修</a>
              <a onclick="subject.switch(241)">周二晚修</a>
              <a onclick="subject.switch(242)">周三晚修</a>
              <a onclick="subject.switch(251)">周四晚修</a>
              <a onclick="subject.switch(252)">周五考试</a>
              <a onclick="subject.switch(261)">单周自主反馈</a>
              <a onclick="subject.switch(262)">双周自主反馈</a>
              <!-- <a onclick="subject.switch(23)">23届<span class="shield">彩蛋</span></a> -->
              <a onclick="setTemp()"><i class="fa-regular fa-square-plus"></i> 临时</a>
              <a onclick="setTimer()"><i class="fa-solid fa-stopwatch"></i> 倒计时</a>
            </div>
          </div>

          <a class="fa-solid fa-compass hilit" href="http://10.50.216.250:11451" data-sub="导航"></a>

          <div class="dropdown">
            <a class="fa-solid fa-images" data-sub="背景"></a>
            <div style="right:-4em;min-width:13em;">
              <div><i class="fa-solid fa-wand-magic-sparkles"></i> 选张背景
                <div class="shieldlist" id="bgVolList">
                  <a onclick="playCover(bg())">全部</a>
                </div>
              </div>
              <div>
                <p>
                  <span class="shield">对数字时钟感兴趣的伙伴可加入二初腾云技协，为塘厦第二初级中学的数字化建设奉献一份力量!</span>
                  <span class="shield">申请入群时：请以班级+姓名为标识进行申请</span>
                  <i class="fa-solid fa-users"></i> 腾云技协QQ群：465702212
                </p>
                <!-- <p class="dim">遵照
                  <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a>
                  协议使用作品。
                </p> -->
                <a href="https://txecyhy.github.io/p/%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87%E8%87%B3%E4%BA%8C%E5%88%9D%E5%9B%BE%E5%BA%93%E5%8F%8A%E5%B7%B2%E9%80%9A%E8%BF%87%E5%9B%BE%E7%89%87%E5%90%8D%E5%8D%95/">
                  <i class="fa-solid fa-file-arrow-up"></i> 上传图片至图库教程点我
                </a>
              </div>
              <a href="https://img.tg/album/er-chu-tu-ku.Oedxj">
                <i class="fa-solid fa-box-archive"></i> 二初图库
              </a>
            </div>
          </div>

          <a onclick="document.documentElement.style.filter='';this.style.display='none'"
            class="fa-solid fa-circle-half-stroke" id="filterSwitch" style="display:none" data-sub="关闭滤镜"></a>

          <div class="dropdown">
            <a class="fa-solid fa-bars" data-sub="菜单"></a>
            <div style="right:-2em;min-width:10em;">
              <!-- <a download='跳转到数字时钟' href='/jump-to-exam-clock'>
                <i class="fa-solid fa-file-arrow-down"></i> 下载快捷方式
                <p class="dim">失败可右键-目标链接另存为</p>
              </a> -->
              <a> <i class="fa-brands fa-qq"></i>反馈QQ号
                <p class="dim">QQ号：3586638355(806yhy)/3857135022(801lwj)</p>
              </a>
              <div><i class="fa-solid fa-gears"></i> 开发选项
                <div class="shieldlist">
                 <!-- <a onclick="slogan.main=prompt('晚修大标语',slogan.main)||slogan.main"> -->
                    <a onclick="sendFeatureRemoved('试图修改大标语时触发')">
                    <i class="fa-solid fa-quote-left"></i> 大标语</a>
                  <a onclick="document.getElementById('subject').innerHTML=prompt('科目名称',subject.name)||subject.name">
                    <i class="fa-solid fa-book"></i> 科目</a>
                  <a onclick="fixMinutes(subject.start,'开始时间')">
                    <i class="fa-solid fa-hourglass-start"></i> 开始时间</a>
                  <a onclick="fixMinutes(subject.end,'结束时间')">
                    <i class="fa-solid fa-hourglass-end"></i> 结束时间</a>
                  <!-- <a onclick="subject.to(prompt('晚修类型',subject.current))">
                  <i class="fa-solid fa-box-archive"></i> 类型</a>  -->
                  <!-- “离谱了，同样的代码在控制台和点击执行出来的就不一样” -->
                  <!-- <a onclick="document.getElementById('type').innerHTML=prompt('机构名称','二初教育')
                    ||exam[subject.current].schedule()">
                    <i class="fa-regular fa-building"></i> 机构</a> -->
                  <a href="?debug=1"><i class="fa-solid fa-bug"></i> 调试</a>
                </div>
              </div>
              <!-- 添加实验性功能区域 -->
              <div><i class="fa-solid fa-flask"></i> 实验性功能(Alpha)
                <div class="shieldlist">
                  <div style="padding:10px;color:#ff9800;font-size:1em;">
                    <i class="fa-solid fa-triangle-exclamation"></i> 
                    警告：这些功能仍在测试中，可能会影响系统稳定性
                  </div>
                  <!-- 实验性功能将在此处添加 -->
                </div>
              </div>

              <div><i class="fa-solid fa-palette"></i> 文字颜色
                <div class="shieldlist">
                  <!-- 保留原有单色选择块 -->
                  <div style="padding:10px;display:grid;grid-template-columns:repeat(5,1fr);gap:5px;">
                    <div style="background:#ff0000;height:20px;border-radius:3px;" onclick="setTextColor('#ff0000')"></div>
                    <div style="background:#00ff00;height:20px;border-radius:3px;" onclick="setTextColor('#00ff00')"></div>
                    <div style="background:#0000ff;height:20px;border-radius:3px;" onclick="setTextColor('#0000ff')"></div>
                    <div style="background:#ffff00;height:20px;border-radius:3px;" onclick="setTextColor('#ffff00')"></div>
                    <div style="background:#ff00ff;height:20px;border-radius:3px;" onclick="setTextColor('#ff00ff')"></div>
                    <div style="background:#00ffff;height:20px;border-radius:3px;" onclick="setTextColor('#00ffff')"></div>
                    <div style="background:#ffffff;height:20px;border-radius:3px;" onclick="setTextColor('#ffffff')"></div>
                    <div style="background:#ff8800;height:20px;border-radius:3px;" onclick="setTextColor('#ff8800')"></div>
                    <div style="background:#8800ff;height:20px;border-radius:3px;" onclick="setTextColor('#8800ff')"></div>
                    <div style="background:#0088ff;height:20px;border-radius:3px;" onclick="setTextColor('#0088ff')"></div>
                  </div>
                  <div style="padding:10px;display:flex;align-items:center">
                    <input type="color" id="customColor" style="width:100px" onchange="setTextColor(this.value)">
                    <span style="margin-left:10px">自定义</span>
                  </div>
                  
                  <!-- 美化渐变色选择区域 -->
                  <div style="padding:10px;">
                    <div style="margin-bottom:8px;font-size:0.9em;color:#aaa;">
                      <i class="fa-solid fa-fill-drip"></i> 渐变色选项
                    </div>
                    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:8px;">
                      <div class="gradient-btn" style="background:linear-gradient(90deg, #ff0000, #0000ff);" 
                           onclick="setGradientColor('#ff0000', '#0000ff')"></div>
                      <div class="gradient-btn" style="background:linear-gradient(90deg, #00ff00, #ff00ff);" 
                           onclick="setGradientColor('#00ff00', '#ff00ff')"></div>
                      <div class="gradient-btn" style="background:linear-gradient(90deg, #0000ff, #ffff00);" 
                           onclick="setGradientColor('#0000ff', '#ffff00')"></div>
                    </div>
                    <div style="display:flex;gap:8px;">
                      <input type="color" id="gradientColor1" style="flex:1;height:30px;" title="起始颜色">
                      <input type="color" id="gradientColor2" style="flex:1;height:30px;" title="结束颜色">
                      <button onclick="applyCustomGradient()" style="padding:0 8px;border-radius:4px;background:#444;color:white;">
                        <i class="fa-solid fa-check"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </div>
              <div><i class="fa-solid fa-snowflake"></i> 雪量控制
                <div class="shieldlist">
                  <div style="padding:10px;display:flex;align-items:center">
                    <input type="range" min="0" max="500" value="50" id="snowAmount" 
                      style="width:100px" oninput="updateSnowAmount(this.value)">
                    <span id="snowValue" style="margin-left:10px">50</span>
                  </div>
                  <div style="padding:10px;color:#ff9800;font-size:0.8em;">
                    <i class="fa-solid fa-triangle-exclamation"></i> 
                    雪花值过大可能会影响班级一体机，请谨慎调整雪量！
                  </div>
                </div>
              </div>
            </div>
          </div>

          <a class="fa-solid fa-expand" id="fullscreen" data-sub="全屏" onclick="fullscreen()"></a>
        </div>
      </nav>

      <div class="dim" id="subslogan"></div>

      <div class="bar">
        <div id="bar"></div>
      </div>

      <b class="card">
        <div>
          <div id="subject" contenteditable>科目</div>
          <div id="duration">16:66~17:77</div>
        </div>
        <div>
          <div id="clock">18:88</div>
        </div>
        <div>
          <div>
            <span id="timer">199</span>
            <span class="dim" id="timersub">sub</span>
          </div>
          <div id="activity">当前科目</div>
        </div>
        <!-- <div><br><br><br>test<br><br><br></div> -->
      </b>
    </div>

    <footer>
      <div class="space-between space">
        <p -data-title="润了"><i class="fa-solid fa-code"></i>
          Coding by: 806YHY, 801lwj Mentor：ZP</p>
        </p>
        <p><i class="fa-solid fa-user-group"></i>
          此动态时钟由东莞市塘厦第二初级中学腾云技协维护, 如果发现课表不对或其他问题, 在校内请联系钟鹏老师!
        </p>
        <p><i class="fa-solid fa-newspaper"></i>
          新闻：愿所有中考考生，看到成绩后，脸上都挂着笑容，就算流泪也是喜极而泣。
        </p>
      </div>
      <div class="space-between space">
        <p data-title="来自二初图库">
          <i class="fa-solid fa-image"></i>
          <span id="bg">背景：学校大门</span>
        </p>
        <p><a href="https://gitee.com/h2ocl/txec-gedc-preview"><i class="fa-brands fa-git"></i>
            源码 <span id="v3.6 Beta">(Gitee)</span></a>
        </p>
        <p><i class="fa-solid fa-file-arrow-up"></i>
          v3.6 Beta 添加了两个实验性功能(注:现在还在测试中)
        </p>
      </div>
    </footer>
  </div>
  <script src="./js/cover.js"></script>
  <script src="./js/clock.js"></script>
  <script>
    // 从Gitee API获取更新
    fetch('https://gitee.com/api/v5/repos/h2ocl/txec-gedc-preview')
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        const updateTime = new Date(data.updated_at).toLocaleString('zh-CN');
        const versionElement = document.getElementById('v3.5.3-R2');
        versionElement.innerHTML = `(Gitee) 最后更新: ${updateTime}`;
      })
      .catch(error => {
        console.error('获取更新失败:', error);
        // Fallback to local version if API fails
        const versionElement = document.getElementById('v3.5.3-R2');
        versionElement.innerHTML = `(Gitee) 本地版本`;
      });
  </script>
  <!-- 移除以下Gitee API更新代码 -->
  <script src="./js/TimeGradeEight.js" defer data-dependencies="clock"></script>
  <script src="./js/search.js" defer data-dependencies="clock"></script>
  <script src="./js/msg.js"></script>
  <script src="./js/interact.js" defer data-dependencies="msg"></script>
  <script src="./js/gallery.js" defer data-dependencies="msg,interact"></script>
  <script src="./js/commit.js" 
    onload="getLastCommit(document.getElementById('v3.5.3-R2'), 'txecyhy/txec-eveningself-studyclock')"></script>
  <script src="./js/snow.js"></script>
  <script>
      let snowflakes = []; // 存储所有雪花对象
      let maxSnowflakes = 50; // 默认雪花数量
      let snowInterval; // 雪花生成间隔器
      
      function updateSnowAmount(value) {
        document.getElementById('snowValue').textContent = value;
        maxSnowflakes = parseInt(value);
        
        // 添加雪量过大警告
        if(value > 300) {
          alert("警告：雪花值过大可能会严重影响班级一体机性能！");
        }
        
        // 清除现有的雪花生成间隔
        if(snowInterval) clearInterval(snowInterval);
        
        // 根据雪量调整生成频率 (100ms-1000ms)
        const interval = 1000 - (900 * (value/500));
        snowInterval = setInterval(createSnowflake, interval);
        
        // 如果当前雪花数量超过最大值，移除多余的雪花
        while(snowflakes.length > maxSnowflakes && snowflakes.length > 0) {
          const flake = snowflakes.pop();
          if(flake && flake.element && flake.element.parentNode) {
            flake.element.parentNode.removeChild(flake.element);
          }
        }
      }
      
      function setClockColor(color) {
        document.getElementById('clock').style.color = color;
        document.getElementById('timer').style.color = color;
        // 保存到本地存储
        localStorage.setItem('clockColor', color);
      }
      
      function setTextColor(color) {
        // 设置所有文字颜色
        const textElements = document.querySelectorAll('#subject, #duration, #clock, #timer, #timersub, #activity');
        textElements.forEach(el => {
          el.style.color = color;
          el.style.backgroundImage = 'none';
        });
        localStorage.setItem('textColor', color);
      }
      
      function setGradientColor() {
        const color1 = prompt('请输入第一种颜色 (如 #ff0000 或 red)', '#ff0000');
        if(!color1) return;
        
        const color2 = prompt('请输入第二种颜色 (如 #0000ff 或 blue)', '#0000ff');
        if(!color2) return;
        
        const gradient = `linear-gradient(90deg, ${color1}, ${color2})`;
        const textElements = document.querySelectorAll('#subject, #duration, #clock, #timer, #timersub, #activity');
        
        textElements.forEach(el => {
          el.style.backgroundImage = gradient;
          el.style.webkitBackgroundClip = 'text';
          el.style.backgroundClip = 'text';
          el.style.color = 'transparent';
        });
        
        localStorage.setItem('textGradient', gradient);
      }
      
      // 初始化时读取保存的颜色
      document.addEventListener('DOMContentLoaded', function() {
        const savedColor = localStorage.getItem('textColor');
        const savedGradient = localStorage.getItem('textGradient');
        
        if(savedGradient) {
          const textElements = document.querySelectorAll('#subject, #duration, #clock, #timer, #timersub, #activity');
          textElements.forEach(el => {
            el.style.backgroundImage = savedGradient;
            el.style.webkitBackgroundClip = 'text';
            el.style.backgroundClip = 'text';
            el.style.color = 'transparent';
          });
        } else if(savedColor) {
          setTextColor(savedColor);
        }
      });
    </script>
<script src="./js/color.js" defer></script>
</body>